/*
    小根堆_笛卡尔树 O(n) 
    1. 结点一一对应于数列元素。即数列中的每个元素都对应于树中某个唯一结点，树结点也对应于数列中的某个唯一元素
    2. 中序遍历（in-order traverse）笛卡尔树即可得到原数列。即任意树结点的左子树结点所对应的数列元素下标比该结点所对应元素的下标小，右子树结点所对应数列元素下标比该结点所对应元素下标大。
    3. 树结构存在堆序性质，即任意树结点所对应数值大／小于其左、右子树内任意结点对应数值
*/

int stk[N];

for (int i = 1, top = 0, k; i <= n; i++) {
    k = top;
    while (k > 0 && p[stk[k]] > p[i]) k--;
    if (k) rs[stk[k]] = i;
    if (k < top) ls[i] = stk[k + 1];
    stk[++k] = i;
    top = k;
}